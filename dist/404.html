<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Charles Robertson :: </title>
    <meta name="description" content="The web design portfolio of Charles Robertson">
    <!-- Stylesheets -->
    <link rel="stylesheet" href="/style.css">
    
    
    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
    <link rel="manifest" href="/favicons/site.webmanifest">
    <link rel="mask-icon" href="/favicons/safari-pinned-tab.svg" color="#36ffb4">
    <link rel="shortcut icon" href="/favicons/favicon.ico">
    <meta name="msapplication-TileColor" content="#36ffb4">
    <meta name="msapplication-config" content="/favicons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff"></head>
  <body id="page-top" class="no-js">
    
    <svg style="display:none">
      <symbol id="icon-cocohost" viewbox="0 0 16 16" style="overflow: visible;">
        <path d="M9.78 4.135c2.635 1.522 4.233 3.691 3.567 4.845-.666 1.153-3.343.854-5.98-.668C4.733 6.79 3.136 4.622 3.8 3.468c.666-1.153 3.343-.855 5.98.667z"/><path d="M4.288 13.649A8.574 8.574 0 0016 10.51c-1.036 1.794-5.201 1.329-9.302-1.039C2.645 7.132.171 3.81 1.114 2a8.574 8.574 0 003.174 11.649z"/>
      </symbol>
      <symbol id="icon-codepen" viewbox="0 0 16 16" style="overflow: visible;">
        <path d="M8.526.543a1.264 1.264 0 00-1.42.017L.75 4.988a1.263 1.263 0 00-.54 1.037v4.77a1.262 1.262 0 00.567 1.055l6.46 4.274a1.262 1.262 0 001.393 0l6.59-4.354a1.265 1.265 0 00.57-1.057V6.025a1.263 1.263 0 00-.57-1.05L8.526.543zm4.922 5.168l-2.436 1.635L8.73 5.685l-.015-3.267 4.734 3.293zM7.061 2.42v3.197L4.724 7.255 2.386 5.69 7.061 2.42zM1.747 7.265l1.51 1.013-1.51 1.057v-2.07zM7.1 14.082L2.387 10.92l2.355-1.645 2.36 1.582v3.225zm-.895-5.83l1.527-1.068L9.51 8.353 7.938 9.41 6.206 8.25zm2.56 5.83v-3.226l2.255-1.51 2.427 1.595-4.681 3.14zm5.355-4.692l-1.6-1.052 1.6-1.074V9.39z"/>
      </symbol>
      <symbol id="icon-github" viewbox="0 0 16 16" style="overflow: visible;">
        <path d="M8.002 0a8 8 0 00-2.53 15.59c.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82a7.542 7.542 0 014 0c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.005 8.005 0 008.002 0z"/>
      </symbol>
      <symbol id="icon-twitter" viewbox="0 0 16 16" style="overflow: visible;">
        <path d="M5.02 14.833c6.042 0 9.345-5.002 9.345-9.338 0-.143 0-.286-.007-.422A6.726 6.726 0 0016 3.37a6.67 6.67 0 01-1.887.518 3.28 3.28 0 001.444-1.818c-.645.381-1.35.65-2.084.797a3.287 3.287 0 00-5.68 2.246c-.003.252.027.504.088.748a9.323 9.323 0 01-6.77-3.43 3.279 3.279 0 001.021 4.376A3.228 3.228 0 01.647 6.4v.04a3.284 3.284 0 002.636 3.22 3.276 3.276 0 01-1.485.055 3.277 3.277 0 003.065 2.28A6.606 6.606 0 010 13.349a9.155 9.155 0 005.02 1.484z"/>
      </symbol>
      <symbol id="icon-email" viewbox="0 0 16 16" style="overflow: visible;">
        <path d="M8 10.78c.52 0 1.028-.16 1.459-.458L16 5.827v7.436c0 .328-.128.642-.354.873a1.196 1.196 0 01-.852.364H1.206a1.196 1.196 0 01-.852-.364A1.256 1.256 0 010 13.264V5.827l6.541 4.495c.431.298.94.457 1.459.457z"/>
        <path d="M8 9.386c-.25 0-.495-.077-.703-.22L0 4.151V2.737c0-.328.128-.642.354-.874.226-.231.532-.362.852-.363h13.588c.32.001.626.132.852.363.226.232.353.546.354.874V4.15L8.703 9.165c-.208.144-.453.22-.703.22z"/>
      </symbol>
      <symbol id="icon-close" viewBox="0 0 32 32" style="overflow: visible;">
        <path d="M0, 0 L32, 32 M32, 0 L0, 32"></path>
      </symbol>
      <symbol id="icon-play" viewBox="0 0 24 20" style="overflow: visible;">
        <path d="M4 0L24 10L4 20V0z"/>
      </symbol>
      <symbol id="icon-pause" viewBox="0 0 24 20" style="overflow: visible;">
        <rect width="7" height="20" x="2"/>
        <rect width="7" height="20" x="15"/>
      </symbol>
    </svg>
    <header class="header header-facehead">
    <div class="facehead">
        <div class="facehead-code">
            <div style="opacity: .8; color: #d6deeb;font-family: Menlo, Monaco, 'Courier New', monospace;font-weight: normal;"><div><span style="color: #d6deeb;">WebGLMultipleRenderTargets</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #7fdbca;">prototype</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">isWebGLMultipleRenderTargets</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #ff5874;">true</span><span style="color: #d6deeb;">;</span></div><br><div><span style="color: #c792ea;">class</span><span style="color: #d6deeb;"> </span><span style="color: #ffcb8b;">WebGLMultisampleRenderTarget</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;font-style: italic;">extends</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">WebGLRenderTarget</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;">constructor</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">width</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">height</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">options</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">super</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">width</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">height</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">options</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">samples</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">4</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">copy</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">source</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">super</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #faf39f;font-style: italic;">copy</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">call</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">source</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">samples</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">source</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">samples</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">}</span></div><br><div><span style="color: #d6deeb;">WebGLMultisampleRenderTarget</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #7fdbca;">prototype</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">isWebGLMultisampleRenderTarget</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #ff5874;">true</span><span style="color: #d6deeb;">;</span></div><br><div><span style="color: #c792ea;">class</span><span style="color: #d6deeb;"> </span><span style="color: #ffcb8b;">Quaternion</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;">constructor</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">1</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">w</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">static</span><span style="color: #d6deeb;"> </span><span style="color: #82aaff;font-style: italic;">slerp</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">qa</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">qb</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">qm</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">t</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;font-style: italic;">console</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">warn</span><span style="color: #d6deeb;">(</span><span style="color: #d9f5dd;">'</span><span style="color: #ecc48d;">THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead.</span><span style="color: #d9f5dd;">'</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">qm</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">slerpQuaternions</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">qa</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">qb</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">t</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">static</span><span style="color: #d6deeb;"> </span><span style="color: #82aaff;font-style: italic;">slerpFlat</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">dst</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">dstOffset</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">src0</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">srcOffset0</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">src1</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">srcOffset1</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">t</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #637777;">//</span><span style="color: #637777;font-style: italic;"> fuzz-free, array-based Quaternion SLERP operation</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">let </span><span style="color: #d7dbe0;">x0</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">src0</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">srcOffset0</span><span style="color: #d6deeb;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;font-style: italic;"> </span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;">]</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">y0</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">src0</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">srcOffset0</span><span style="color: #d6deeb;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;font-style: italic;"> </span><span style="color: #f78c6c;">1</span><span style="color: #d6deeb;">]</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">z0</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">src0</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">srcOffset0</span><span style="color: #d6deeb;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;font-style: italic;"> </span><span style="color: #f78c6c;">2</span><span style="color: #d6deeb;">]</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">w0</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">src0</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">srcOffset0</span><span style="color: #d6deeb;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;font-style: italic;"> </span><span style="color: #f78c6c;">3</span><span style="color: #d6deeb;">];</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">x1</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">src1</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">srcOffset1</span><span style="color: #d6deeb;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;font-style: italic;"> </span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;">]</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">y1</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">src1</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">srcOffset1</span><span style="color: #d6deeb;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;font-style: italic;"> </span><span style="color: #f78c6c;">1</span><span style="color: #d6deeb;">]</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">z1</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">src1</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">srcOffset1</span><span style="color: #d6deeb;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;font-style: italic;"> </span><span style="color: #f78c6c;">2</span><span style="color: #d6deeb;">]</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">w1</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">src1</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">srcOffset1</span><span style="color: #d6deeb;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;font-style: italic;"> </span><span style="color: #f78c6c;">3</span><span style="color: #d6deeb;">];</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">if</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">t</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">===</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;">) {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">dst</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">dstOffset</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x0</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">dst</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">dstOffset</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">1</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y0</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">dst</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">dstOffset</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">2</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z0</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">dst</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">dstOffset</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">3</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">w0</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">if</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">t</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">===</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">1</span><span style="color: #d6deeb;">) {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">dst</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">dstOffset</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x1</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">dst</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">dstOffset</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">1</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y1</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">dst</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">dstOffset</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">2</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z1</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">dst</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">dstOffset</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">3</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">w1</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">if</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">w0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">!==</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">w1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">||</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">!==</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">||</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">!==</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">||</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">!==</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z1</span><span style="color: #d6deeb;">) {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">let </span><span style="color: #d7dbe0;">s</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #f78c6c;">1</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">-</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">t</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">cos</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">x0</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">x1</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">y0</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">y1</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">z0</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">z1</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">w0</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">w1</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">dir</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">cos</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">&gt;=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #f78c6c;">0</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">?</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #f78c6c;">1</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">:</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">-</span><span style="color: #f78c6c;">1</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">sqrSin</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #f78c6c;">1</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">-</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">cos</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">cos</span><span style="color: #d6deeb;">; </span><span style="color: #637777;">//</span><span style="color: #637777;font-style: italic;"> Skip the Slerp for tiny steps to avoid numeric problems:</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">if</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">sqrSin</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">&gt;</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Number</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #d6deeb;">EPSILON) {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">sin</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c5e478;font-style: italic;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;font-style: italic;">sqrt</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">sqrSin</span><span style="color: #d6deeb;">)</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">len</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c5e478;font-style: italic;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;font-style: italic;">atan2</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">sin</span><span style="color: #c792ea;">,</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">cos</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">dir</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">sin</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">len</span><span style="color: #d6deeb;">) </span><span style="color: #c792ea;">/</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">sin</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">t</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">sin</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">t</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">len</span><span style="color: #d6deeb;">) </span><span style="color: #c792ea;">/</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">sin</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">tDir</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">t</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">dir</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">x0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">tDir</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">y0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">tDir</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">z0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">tDir</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">w0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">w0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">w1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">tDir</span><span style="color: #d6deeb;">; </span><span style="color: #637777;">//</span><span style="color: #637777;font-style: italic;"> Normalize in case we just did a lerp:</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">if</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">===</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">t</span><span style="color: #d6deeb;">) {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">f</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #f78c6c;">1</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">/</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c5e478;font-style: italic;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;font-style: italic;">sqrt</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">x0</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">x0</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">y0</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">y0</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">z0</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">z0</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">w0</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">w0</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">x0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">f</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">y0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">f</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">z0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">f</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">w0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">f</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">dst</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">dstOffset</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x0</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">dst</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">dstOffset</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">1</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y0</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">dst</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">dstOffset</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">2</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z0</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">dst</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">dstOffset</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">3</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">w0</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">static</span><span style="color: #d6deeb;"> </span><span style="color: #82aaff;font-style: italic;">multiplyQuaternionsFlat</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">dst</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">dstOffset</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">src0</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">srcOffset0</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">src1</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">srcOffset1</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">x0</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">src0</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">srcOffset0</span><span style="color: #d6deeb;">];</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">y0</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">src0</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">srcOffset0</span><span style="color: #d6deeb;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;font-style: italic;"> </span><span style="color: #f78c6c;">1</span><span style="color: #d6deeb;">];</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">z0</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">src0</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">srcOffset0</span><span style="color: #d6deeb;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;font-style: italic;"> </span><span style="color: #f78c6c;">2</span><span style="color: #d6deeb;">];</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">w0</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">src0</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">srcOffset0</span><span style="color: #d6deeb;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;font-style: italic;"> </span><span style="color: #f78c6c;">3</span><span style="color: #d6deeb;">];</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">x1</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">src1</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">srcOffset1</span><span style="color: #d6deeb;">];</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">y1</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">src1</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">srcOffset1</span><span style="color: #d6deeb;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;font-style: italic;"> </span><span style="color: #f78c6c;">1</span><span style="color: #d6deeb;">];</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">z1</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">src1</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">srcOffset1</span><span style="color: #d6deeb;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;font-style: italic;"> </span><span style="color: #f78c6c;">2</span><span style="color: #d6deeb;">];</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">w1</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">src1</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">srcOffset1</span><span style="color: #d6deeb;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;font-style: italic;"> </span><span style="color: #f78c6c;">3</span><span style="color: #d6deeb;">];</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">dst</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">dstOffset</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">w1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">w0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y1</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">dst</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">dstOffset</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">1</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">w1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">w0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z1</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">dst</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">dstOffset</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">2</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">w1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">w0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x1</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">dst</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">dstOffset</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">3</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">w0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">w1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z1</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">dst</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">get</span><span style="color: #d6deeb;"> </span><span style="color: #82aaff;font-style: italic;">x</span><span style="color: #d9f5dd;">()</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">set</span><span style="color: #d6deeb;"> </span><span style="color: #82aaff;font-style: italic;">x</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">value</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">value</span><span style="color: #d6deeb;">;</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">_onChangeCallback</span><span style="color: #d6deeb;">();</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">get</span><span style="color: #d6deeb;"> </span><span style="color: #82aaff;font-style: italic;">y</span><span style="color: #d9f5dd;">()</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">set</span><span style="color: #d6deeb;"> </span><span style="color: #82aaff;font-style: italic;">y</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">value</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">value</span><span style="color: #d6deeb;">;</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">_onChangeCallback</span><span style="color: #d6deeb;">();</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">get</span><span style="color: #d6deeb;"> </span><span style="color: #82aaff;font-style: italic;">z</span><span style="color: #d9f5dd;">()</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">set</span><span style="color: #d6deeb;"> </span><span style="color: #82aaff;font-style: italic;">z</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">value</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">value</span><span style="color: #d6deeb;">;</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">_onChangeCallback</span><span style="color: #d6deeb;">();</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">get</span><span style="color: #d6deeb;"> </span><span style="color: #82aaff;font-style: italic;">w</span><span style="color: #d9f5dd;">()</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">set</span><span style="color: #d6deeb;"> </span><span style="color: #82aaff;font-style: italic;">w</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">value</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">value</span><span style="color: #d6deeb;">;</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">_onChangeCallback</span><span style="color: #d6deeb;">();</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">set</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">x</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">y</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">z</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">w</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">w</span><span style="color: #d6deeb;">;</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">_onChangeCallback</span><span style="color: #d6deeb;">();</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">clone</span><span style="color: #d9f5dd;">()</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">new</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">constructor</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;">, </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;">, </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;">, </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">copy</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">quaternion</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">quaternion</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">quaternion</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">quaternion</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">quaternion</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">w</span><span style="color: #d6deeb;">;</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">_onChangeCallback</span><span style="color: #d6deeb;">();</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">setFromEuler</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">euler</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">update</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">if</span><span style="color: #d6deeb;"> (</span><span style="color: #c792ea;">!</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">euler</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">&amp;&amp;</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">euler</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">isEuler</span><span style="color: #d6deeb;">)) {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">throw</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">new</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Error</span><span style="color: #d6deeb;">(</span><span style="color: #d9f5dd;">'</span><span style="color: #ecc48d;">THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.</span><span style="color: #d9f5dd;">'</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">x</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">euler</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">_x</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">y</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">euler</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">_y</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">z</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">euler</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">_z</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">order</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">euler</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">_order</span><span style="color: #d6deeb;">; </span><span style="color: #637777;">//</span><span style="color: #637777;font-style: italic;"> http://www.mathworks.com/matlabcentral/fileexchange/</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #637777;">//</span><span style="color: #637777;font-style: italic;">  20696-function-to-convert-between-dcm-euler-angles-quaternions-and-euler-vectors/</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #637777;">//</span><span style="color: #637777;font-style: italic;">  content/SpinCalc.m</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">cos</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c5e478;font-style: italic;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;font-style: italic;">cos</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">sin</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c5e478;font-style: italic;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;font-style: italic;">sin</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">c1</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #82aaff;font-style: italic;">cos</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">x</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">/</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #f78c6c;">2</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">c2</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #82aaff;font-style: italic;">cos</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">y</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">/</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #f78c6c;">2</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">c3</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #82aaff;font-style: italic;">cos</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">z</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">/</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #f78c6c;">2</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">s1</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #82aaff;font-style: italic;">sin</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">x</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">/</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #f78c6c;">2</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">s2</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #82aaff;font-style: italic;">sin</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">y</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">/</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #f78c6c;">2</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">s3</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #82aaff;font-style: italic;">sin</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">z</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">/</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #f78c6c;">2</span><span style="color: #d6deeb;">);</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">switch</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">order</span><span style="color: #d6deeb;">) {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">case</span><span style="color: #d6deeb;"> </span><span style="color: #d9f5dd;">'</span><span style="color: #ecc48d;">XYZ</span><span style="color: #d9f5dd;">'</span><span style="color: #d6deeb;">:</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c3</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s3</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c3</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s3</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s3</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c3</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c3</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s3</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">break</span><span style="color: #d6deeb;">;</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">case</span><span style="color: #d6deeb;"> </span><span style="color: #d9f5dd;">'</span><span style="color: #ecc48d;">YXZ</span><span style="color: #d9f5dd;">'</span><span style="color: #d6deeb;">:</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c3</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s3</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c3</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s3</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s3</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c3</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c3</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s3</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">break</span><span style="color: #d6deeb;">;</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">case</span><span style="color: #d6deeb;"> </span><span style="color: #d9f5dd;">'</span><span style="color: #ecc48d;">ZXY</span><span style="color: #d9f5dd;">'</span><span style="color: #d6deeb;">:</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c3</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s3</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c3</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s3</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s3</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c3</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c3</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s3</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">break</span><span style="color: #d6deeb;">;</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">case</span><span style="color: #d6deeb;"> </span><span style="color: #d9f5dd;">'</span><span style="color: #ecc48d;">ZYX</span><span style="color: #d9f5dd;">'</span><span style="color: #d6deeb;">:</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c3</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s3</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c3</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s3</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s3</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c3</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c3</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s3</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">break</span><span style="color: #d6deeb;">;</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">case</span><span style="color: #d6deeb;"> </span><span style="color: #d9f5dd;">'</span><span style="color: #ecc48d;">YZX</span><span style="color: #d9f5dd;">'</span><span style="color: #d6deeb;">:</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c3</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s3</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c3</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s3</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s3</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c3</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c3</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s3</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">break</span><span style="color: #d6deeb;">;</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">case</span><span style="color: #d6deeb;"> </span><span style="color: #d9f5dd;">'</span><span style="color: #ecc48d;">XZY</span><span style="color: #d9f5dd;">'</span><span style="color: #d6deeb;">:</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c3</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s3</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c3</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s3</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s3</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c3</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">c3</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s3</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">break</span><span style="color: #d6deeb;">;</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">default</span><span style="color: #d6deeb;">:</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;font-style: italic;">console</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">warn</span><span style="color: #d6deeb;">(</span><span style="color: #d9f5dd;">'</span><span style="color: #ecc48d;">THREE.Quaternion: .setFromEuler() encountered an unknown order: </span><span style="color: #d9f5dd;">'</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">order</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">if</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">update</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">!==</span><span style="color: #d6deeb;"> </span><span style="color: #ff5874;">false</span><span style="color: #d6deeb;">) </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">_onChangeCallback</span><span style="color: #d6deeb;">();</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">setFromAxisAngle</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">axis</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">angle</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #637777;">//</span><span style="color: #637777;font-style: italic;"> http://www.euclideanspace.com/maths/geometry/rotations/conversions/angleToQuaternion/index.htm</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #637777;">//</span><span style="color: #637777;font-style: italic;"> assumes axis is normalized</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">halfAngle</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">angle</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">/</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #f78c6c;">2</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">s</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c5e478;font-style: italic;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;font-style: italic;">sin</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">halfAngle</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">axis</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">axis</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">axis</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">cos</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">halfAngle</span><span style="color: #d6deeb;">);</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">_onChangeCallback</span><span style="color: #d6deeb;">();</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">setFromRotationMatrix</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">m</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #637777;">//</span><span style="color: #637777;font-style: italic;"> http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #637777;">//</span><span style="color: #637777;font-style: italic;"> assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">te</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">m</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">elements</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">m11</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">te</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;">]</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">m12</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">te</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">4</span><span style="color: #d6deeb;">]</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">m13</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">te</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">8</span><span style="color: #d6deeb;">]</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">m21</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">te</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">1</span><span style="color: #d6deeb;">]</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">m22</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">te</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">5</span><span style="color: #d6deeb;">]</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">m23</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">te</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">9</span><span style="color: #d6deeb;">]</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">m31</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">te</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">2</span><span style="color: #d6deeb;">]</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">m32</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">te</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">6</span><span style="color: #d6deeb;">]</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">m33</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">te</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">10</span><span style="color: #d6deeb;">]</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">trace</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">m11</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">m22</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">m33</span><span style="color: #d6deeb;">;</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">if</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">trace</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">&gt;</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;">) {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">s</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #f78c6c;">0.5</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">/</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c5e478;font-style: italic;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;font-style: italic;">sqrt</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">trace</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #f78c6c;">1.0</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">0.25</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">/</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">m32</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">m23</span><span style="color: #d6deeb;">) </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">m13</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">m31</span><span style="color: #d6deeb;">) </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">m21</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">m12</span><span style="color: #d6deeb;">) </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} </span><span style="color: #c792ea;">else</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">if</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">m11</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">&gt;</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">m22</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">&amp;&amp;</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">m11</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">&gt;</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">m33</span><span style="color: #d6deeb;">) {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">s</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #f78c6c;">2.0</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c5e478;font-style: italic;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;font-style: italic;">sqrt</span><span style="color: #d6deeb;">(</span><span style="color: #f78c6c;">1.0</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">m11</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">-</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">m22</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">-</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">m33</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">m32</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">m23</span><span style="color: #d6deeb;">) </span><span style="color: #c792ea;">/</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">0.25</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">m12</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">m21</span><span style="color: #d6deeb;">) </span><span style="color: #c792ea;">/</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">m13</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">m31</span><span style="color: #d6deeb;">) </span><span style="color: #c792ea;">/</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} </span><span style="color: #c792ea;">else</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">if</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">m22</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">&gt;</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">m33</span><span style="color: #d6deeb;">) {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">s</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #f78c6c;">2.0</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c5e478;font-style: italic;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;font-style: italic;">sqrt</span><span style="color: #d6deeb;">(</span><span style="color: #f78c6c;">1.0</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">m22</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">-</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">m11</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">-</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">m33</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">m13</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">m31</span><span style="color: #d6deeb;">) </span><span style="color: #c792ea;">/</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">m12</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">m21</span><span style="color: #d6deeb;">) </span><span style="color: #c792ea;">/</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">0.25</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">m23</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">m32</span><span style="color: #d6deeb;">) </span><span style="color: #c792ea;">/</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} </span><span style="color: #c792ea;">else</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">s</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #f78c6c;">2.0</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c5e478;font-style: italic;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;font-style: italic;">sqrt</span><span style="color: #d6deeb;">(</span><span style="color: #f78c6c;">1.0</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">m33</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">-</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">m11</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">-</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">m22</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">m21</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">m12</span><span style="color: #d6deeb;">) </span><span style="color: #c792ea;">/</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">m13</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">m31</span><span style="color: #d6deeb;">) </span><span style="color: #c792ea;">/</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">m23</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">m32</span><span style="color: #d6deeb;">) </span><span style="color: #c792ea;">/</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">0.25</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">_onChangeCallback</span><span style="color: #d6deeb;">();</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">setFromUnitVectors</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">vFrom</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">vTo</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #637777;">//</span><span style="color: #637777;font-style: italic;"> assumes direction vectors vFrom and vTo are normalized</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">let </span><span style="color: #d7dbe0;">r</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">vFrom</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">dot</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">vTo</span><span style="color: #d6deeb;">)</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #f78c6c;">1</span><span style="color: #d6deeb;">;</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">if</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">r</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">&lt;</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Number</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #d6deeb;">EPSILON) {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #637777;">//</span><span style="color: #637777;font-style: italic;"> vFrom and vTo point in opposite directions</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">r</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;">;</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">if</span><span style="color: #d6deeb;"> (</span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">abs</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;font-style: italic;">vFrom</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;">) </span><span style="color: #c792ea;">&gt;</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">abs</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;font-style: italic;">vFrom</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">)) {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #7fdbca;font-style: italic;">vFrom</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">vFrom</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">r</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} </span><span style="color: #c792ea;">else</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #7fdbca;font-style: italic;">vFrom</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">vFrom</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">r</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} </span><span style="color: #c792ea;">else</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #637777;">//</span><span style="color: #637777;font-style: italic;"> crossVectors( vFrom, vTo ); // inlined to avoid cyclic dependency on Vector3</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">vFrom</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">vTo</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">vFrom</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">vTo</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">vFrom</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">vTo</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">vFrom</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">vTo</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">vFrom</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">vTo</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">vFrom</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">vTo</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">r</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">normalize</span><span style="color: #d6deeb;">();</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">angleTo</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">q</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">2</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">acos</span><span style="color: #d6deeb;">(</span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">abs</span><span style="color: #d6deeb;">(</span><span style="color: #82aaff;font-style: italic;">clamp</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">dot</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">q</span><span style="color: #d6deeb;">), </span><span style="color: #c792ea;">-</span><span style="color: #f78c6c;">1</span><span style="color: #d6deeb;">, </span><span style="color: #f78c6c;">1</span><span style="color: #d6deeb;">)));</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">rotateTowards</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">q</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">step</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">angle</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">angleTo</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">q</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">if</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">angle</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">===</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;">) </span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">t</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c5e478;font-style: italic;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;font-style: italic;">min</span><span style="color: #d6deeb;">(</span><span style="color: #f78c6c;">1</span><span style="color: #c792ea;">,</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">step</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">/</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">angle</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">slerp</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">q</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">t</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">identity</span><span style="color: #d9f5dd;">()</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">set</span><span style="color: #d6deeb;">(</span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;">, </span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;">, </span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;">, </span><span style="color: #f78c6c;">1</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">invert</span><span style="color: #d9f5dd;">()</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #637777;">//</span><span style="color: #637777;font-style: italic;"> quaternion is assumed to have unit length</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">conjugate</span><span style="color: #d6deeb;">();</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">conjugate</span><span style="color: #d9f5dd;">()</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*=</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #f78c6c;">1</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*=</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #f78c6c;">1</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*=</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #f78c6c;">1</span><span style="color: #d6deeb;">;</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">_onChangeCallback</span><span style="color: #d6deeb;">();</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">dot</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">v</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">lengthSq</span><span style="color: #d9f5dd;">()</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">length</span><span style="color: #d9f5dd;">()</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">sqrt</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">normalize</span><span style="color: #d9f5dd;">()</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">let </span><span style="color: #d7dbe0;">l</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">length</span><span style="color: #d6deeb;">();</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">if</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">l</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">===</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;">) {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">1</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} </span><span style="color: #c792ea;">else</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">l</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">/</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">l</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">l</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">l</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">l</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">l</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">_onChangeCallback</span><span style="color: #d6deeb;">();</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">multiply</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">q</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">p</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">if</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">p</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">!==</span><span style="color: #d6deeb;"> </span><span style="color: #82aaff;">undefined</span><span style="color: #d6deeb;">) {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;font-style: italic;">console</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">warn</span><span style="color: #d6deeb;">(</span><span style="color: #d9f5dd;">'</span><span style="color: #ecc48d;">THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.</span><span style="color: #d9f5dd;">'</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">multiplyQuaternions</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">q</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">p</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">multiplyQuaternions</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">q</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">premultiply</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">q</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">multiplyQuaternions</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">q</span><span style="color: #d6deeb;">, </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">multiplyQuaternions</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">a</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">b</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #637777;">//</span><span style="color: #637777;font-style: italic;"> from http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/code/index.htm</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">qax</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">a</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">_x</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">qay</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">a</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">_y</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">qaz</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">a</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">_z</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">qaw</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">a</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">_w</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">qbx</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">b</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">_x</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">qby</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">b</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">_y</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">qbz</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">b</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">_z</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">qbw</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">b</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">_w</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qax</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qbw</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qaw</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qbx</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qay</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qbz</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qaz</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qby</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qay</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qbw</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qaw</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qby</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qaz</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qbx</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qax</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qbz</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qaz</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qbw</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qaw</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qbz</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qax</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qby</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qay</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qbx</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qaw</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qbw</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qax</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qbx</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qay</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qby</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qaz</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qbz</span><span style="color: #d6deeb;">;</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">_onChangeCallback</span><span style="color: #d6deeb;">();</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">slerp</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">qb</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">t</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">if</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">t</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">===</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;">) </span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">if</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">t</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">===</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">1</span><span style="color: #d6deeb;">) </span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">copy</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">qb</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">x</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">_x</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">y</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">_y</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">z</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">_z</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">w</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">_w</span><span style="color: #d6deeb;">; </span><span style="color: #637777;">//</span><span style="color: #637777;font-style: italic;"> http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/slerp/</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">let </span><span style="color: #d7dbe0;">cosHalfTheta</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">w</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">qb</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">_w</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">x</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">qb</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">_x</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">y</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">qb</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">_y</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">z</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">qb</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">_z</span><span style="color: #d6deeb;">;</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">if</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">cosHalfTheta</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">&lt;</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;">) {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #7fdbca;font-style: italic;">qb</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #7fdbca;font-style: italic;">qb</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #7fdbca;font-style: italic;">qb</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #7fdbca;font-style: italic;">qb</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">cosHalfTheta</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d7dbe0;">cosHalfTheta</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} </span><span style="color: #c792ea;">else</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">copy</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">qb</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">if</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">cosHalfTheta</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">&gt;=</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">1.0</span><span style="color: #d6deeb;">) {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">w</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">sqrSinHalfTheta</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #f78c6c;">1.0</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">-</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">cosHalfTheta</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">cosHalfTheta</span><span style="color: #d6deeb;">;</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">if</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">sqrSinHalfTheta</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">&lt;=</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Number</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #d6deeb;">EPSILON) {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">s</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #f78c6c;">1</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">-</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">t</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">t</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">t</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">t</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">t</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">normalize</span><span style="color: #d6deeb;">();</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">_onChangeCallback</span><span style="color: #d6deeb;">();</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">sinHalfTheta</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c5e478;font-style: italic;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;font-style: italic;">sqrt</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">sqrSinHalfTheta</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">halfTheta</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c5e478;font-style: italic;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;font-style: italic;">atan2</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">sinHalfTheta</span><span style="color: #c792ea;">,</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">cosHalfTheta</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">ratioA</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c5e478;font-style: italic;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;font-style: italic;">sin</span><span style="color: #d6deeb;">((</span><span style="color: #f78c6c;">1</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">-</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">t</span><span style="color: #d6deeb;">)</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">halfTheta</span><span style="color: #d6deeb;">)</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">/</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">sinHalfTheta</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">ratioB</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c5e478;font-style: italic;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;font-style: italic;">sin</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">t</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">halfTheta</span><span style="color: #d6deeb;">)</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">/</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">sinHalfTheta</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">ratioA</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">ratioB</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">ratioA</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">ratioB</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">ratioA</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">ratioB</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">ratioA</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">ratioB</span><span style="color: #d6deeb;">;</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">_onChangeCallback</span><span style="color: #d6deeb;">();</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">slerpQuaternions</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">qa</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">qb</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">t</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">copy</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">qa</span><span style="color: #d6deeb;">)</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">slerp</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">qb</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">t</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">equals</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">quaternion</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">quaternion</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">===</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">&amp;&amp;</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">quaternion</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">===</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">&amp;&amp;</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">quaternion</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">===</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">&amp;&amp;</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">quaternion</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">===</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">fromArray</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">array</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">offset</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">0</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">array</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">offset</span><span style="color: #d6deeb;">];</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">array</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">offset</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">1</span><span style="color: #d6deeb;">];</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">array</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">offset</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">2</span><span style="color: #d6deeb;">];</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">array</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">offset</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">3</span><span style="color: #d6deeb;">];</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">_onChangeCallback</span><span style="color: #d6deeb;">();</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">toArray</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">array</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> [], </span><span style="color: #d7dbe0;">offset</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">0</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">array</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">offset</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">array</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">offset</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">1</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">array</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">offset</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">2</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #d7dbe0;">array</span><span style="color: #d6deeb;">[</span><span style="color: #d7dbe0;">offset</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">3</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">array</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">fromBufferAttribute</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">attribute</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">index</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">attribute</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">getX</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">index</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">attribute</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">getY</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">index</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">attribute</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">getZ</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">index</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">attribute</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">getW</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">index</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">_onChange</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">callback</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">_onChangeCallback</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">callback</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">_onChangeCallback</span><span style="color: #d9f5dd;">()</span><span style="color: #d6deeb;"> {}</span></div><br><div><span style="color: #d6deeb;">}</span></div><br><div><span style="color: #d6deeb;">Quaternion</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #7fdbca;">prototype</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">isQuaternion</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #ff5874;">true</span><span style="color: #d6deeb;">;</span></div><br><div><span style="color: #c792ea;">class</span><span style="color: #d6deeb;"> </span><span style="color: #ffcb8b;">Vector3</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;">constructor</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">0</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">set</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">x</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">y</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">z</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">if</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">===</span><span style="color: #d6deeb;"> </span><span style="color: #82aaff;">undefined</span><span style="color: #d6deeb;">) </span><span style="color: #d7dbe0;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">; </span><span style="color: #637777;">//</span><span style="color: #637777;font-style: italic;"> sprite.scale.set(x,y)</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">setScalar</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">scalar</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">scalar</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">scalar</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">scalar</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">setX</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">x</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">setY</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">y</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">setZ</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">z</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">setComponent</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">index</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">value</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">switch</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">index</span><span style="color: #d6deeb;">) {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">case</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;">:</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">value</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">break</span><span style="color: #d6deeb;">;</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">case</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">1</span><span style="color: #d6deeb;">:</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">value</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">break</span><span style="color: #d6deeb;">;</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">case</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">2</span><span style="color: #d6deeb;">:</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">value</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">break</span><span style="color: #d6deeb;">;</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">default</span><span style="color: #d6deeb;">:</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">throw</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">new</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Error</span><span style="color: #d6deeb;">(</span><span style="color: #d9f5dd;">'</span><span style="color: #ecc48d;">index is out of range: </span><span style="color: #d9f5dd;">'</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">index</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">getComponent</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">index</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">switch</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">index</span><span style="color: #d6deeb;">) {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">case</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;">:</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;">;</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">case</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">1</span><span style="color: #d6deeb;">:</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;">;</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">case</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">2</span><span style="color: #d6deeb;">:</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">;</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">default</span><span style="color: #d6deeb;">:</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">throw</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">new</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Error</span><span style="color: #d6deeb;">(</span><span style="color: #d9f5dd;">'</span><span style="color: #ecc48d;">index is out of range: </span><span style="color: #d9f5dd;">'</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">index</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">clone</span><span style="color: #d9f5dd;">()</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">new</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">constructor</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;">, </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;">, </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">copy</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">v</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">add</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">v</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">w</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">if</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">!==</span><span style="color: #d6deeb;"> </span><span style="color: #82aaff;">undefined</span><span style="color: #d6deeb;">) {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;font-style: italic;">console</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">warn</span><span style="color: #d6deeb;">(</span><span style="color: #d9f5dd;">'</span><span style="color: #ecc48d;">THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead.</span><span style="color: #d9f5dd;">'</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">addVectors</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">v</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">w</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">addScalar</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">s</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">addVectors</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">a</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">b</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">a</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">b</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">a</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">b</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">a</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">b</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">addScaledVector</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">v</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">s</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">sub</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">v</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">w</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">if</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">!==</span><span style="color: #d6deeb;"> </span><span style="color: #82aaff;">undefined</span><span style="color: #d6deeb;">) {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;font-style: italic;">console</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">warn</span><span style="color: #d6deeb;">(</span><span style="color: #d9f5dd;">'</span><span style="color: #ecc48d;">THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.</span><span style="color: #d9f5dd;">'</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">subVectors</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">v</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">w</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">subScalar</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">s</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">s</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">subVectors</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">a</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">b</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">a</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">b</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">a</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">b</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">a</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">b</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">multiply</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">v</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">w</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">if</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">!==</span><span style="color: #d6deeb;"> </span><span style="color: #82aaff;">undefined</span><span style="color: #d6deeb;">) {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;font-style: italic;">console</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">warn</span><span style="color: #d6deeb;">(</span><span style="color: #d9f5dd;">'</span><span style="color: #ecc48d;">THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.</span><span style="color: #d9f5dd;">'</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">multiplyVectors</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">v</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">w</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">multiplyScalar</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">scalar</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">scalar</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">scalar</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">scalar</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">multiplyVectors</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">a</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">b</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">a</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">b</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">a</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">b</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">a</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">b</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">applyEuler</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">euler</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">if</span><span style="color: #d6deeb;"> (</span><span style="color: #c792ea;">!</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">euler</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">&amp;&amp;</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">euler</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">isEuler</span><span style="color: #d6deeb;">)) {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;font-style: italic;">console</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">error</span><span style="color: #d6deeb;">(</span><span style="color: #d9f5dd;">'</span><span style="color: #ecc48d;">THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order.</span><span style="color: #d9f5dd;">'</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">applyQuaternion</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;font-style: italic;">_quaternion$4</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">setFromEuler</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">euler</span><span style="color: #d6deeb;">));</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">applyAxisAngle</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">axis</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">angle</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">applyQuaternion</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;font-style: italic;">_quaternion$4</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">setFromAxisAngle</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">axis</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">angle</span><span style="color: #d6deeb;">));</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">applyMatrix3</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">m</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">x</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">x</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">y</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">y</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">z</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">e</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">m</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">elements</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">3</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">6</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">1</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">4</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">7</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">2</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">5</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">8</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">applyNormalMatrix</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">m</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">applyMatrix3</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">m</span><span style="color: #d6deeb;">)</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">normalize</span><span style="color: #d6deeb;">();</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">applyMatrix4</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">m</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">x</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">x</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">y</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">y</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">z</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">e</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">m</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">elements</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">w</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #f78c6c;">1</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">/</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">3</span><span style="color: #d6deeb;">]</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">x</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">7</span><span style="color: #d6deeb;">]</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">y</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">11</span><span style="color: #d6deeb;">]</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">z</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">15</span><span style="color: #d6deeb;">]);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">4</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">8</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">12</span><span style="color: #d6deeb;">]) </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">w</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">1</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">5</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">9</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">13</span><span style="color: #d6deeb;">]) </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">w</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">2</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">6</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">10</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">14</span><span style="color: #d6deeb;">]) </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">w</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">applyQuaternion</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">q</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">x</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">x</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">y</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">y</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">z</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">qx</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">q</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">x</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">qy</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">q</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">y</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">qz</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">q</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">z</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">qw</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">q</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">w</span><span style="color: #d6deeb;">; </span><span style="color: #637777;">//</span><span style="color: #637777;font-style: italic;"> calculate quat * vector</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">ix</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">qw</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">x</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">qy</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">z</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">-</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">qz</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">y</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">iy</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">qw</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">y</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">qz</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">x</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">-</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">qx</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">iz</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">qw</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">z</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">+</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">qx</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">y</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">-</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">qy</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">x</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">iw</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">-</span><span style="color: #d7dbe0;">qx</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">x</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">-</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">qy</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">y</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">-</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">qz</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">*</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #d7dbe0;">z</span><span style="color: #d6deeb;">; </span><span style="color: #637777;">//</span><span style="color: #637777;font-style: italic;"> calculate result * inverse quat</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">ix</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qw</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">iw</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d7dbe0;">qx</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">iy</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d7dbe0;">qz</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">iz</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d7dbe0;">qy</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">iy</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qw</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">iw</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d7dbe0;">qy</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">iz</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d7dbe0;">qx</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">ix</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d7dbe0;">qz</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">iz</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">qw</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">iw</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d7dbe0;">qz</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">ix</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d7dbe0;">qy</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">iy</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d7dbe0;">qx</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">project</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">camera</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">applyMatrix4</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;font-style: italic;">camera</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">matrixWorldInverse</span><span style="color: #d6deeb;">)</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">applyMatrix4</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;font-style: italic;">camera</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">projectionMatrix</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">unproject</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">camera</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">applyMatrix4</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;font-style: italic;">camera</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">projectionMatrixInverse</span><span style="color: #d6deeb;">)</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">applyMatrix4</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;font-style: italic;">camera</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">matrixWorld</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">transformDirection</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">m</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #637777;">//</span><span style="color: #637777;font-style: italic;"> input: THREE.Matrix4 affine matrix</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #637777;">//</span><span style="color: #637777;font-style: italic;"> vector interpreted as a direction</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">x</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">x</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">y</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">y</span><span style="color: #c792ea;">,</span></div><div><span style="color: #c792ea;font-style: italic;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">z</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">e</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">m</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;font-style: italic;">elements</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">4</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">8</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">1</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">5</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">9</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">2</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">6</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">e</span><span style="color: #d6deeb;">[</span><span style="color: #f78c6c;">10</span><span style="color: #d6deeb;">] </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">normalize</span><span style="color: #d6deeb;">();</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">divide</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">v</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">/=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">/=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">/=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">divideScalar</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">scalar</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">multiplyScalar</span><span style="color: #d6deeb;">(</span><span style="color: #f78c6c;">1</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">/</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">scalar</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">min</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">v</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">min</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;">, </span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">min</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;">, </span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">min</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">, </span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">max</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">v</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">max</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;">, </span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">max</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;">, </span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">max</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">, </span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">clamp</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">min</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">max</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #637777;">//</span><span style="color: #637777;font-style: italic;"> assumes min &lt; max, componentwise</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">max</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;font-style: italic;">min</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;">, </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">min</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;font-style: italic;">max</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;">, </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;">));</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">max</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;font-style: italic;">min</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;">, </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">min</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;font-style: italic;">max</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;">, </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;">));</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">max</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;font-style: italic;">min</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">, </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">min</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;font-style: italic;">max</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">, </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">));</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">clampScalar</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">minVal</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">maxVal</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">max</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">minVal</span><span style="color: #d6deeb;">, </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">min</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">maxVal</span><span style="color: #d6deeb;">, </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;">));</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">max</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">minVal</span><span style="color: #d6deeb;">, </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">min</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">maxVal</span><span style="color: #d6deeb;">, </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;">));</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">max</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">minVal</span><span style="color: #d6deeb;">, </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">min</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">maxVal</span><span style="color: #d6deeb;">, </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">));</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">clampLength</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">min</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">max</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">const </span><span style="color: #82aaff;font-style: italic;">length</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #c792ea;">=</span><span style="color: #c792ea;font-style: italic;"> </span><span style="color: #7fdbca;font-style: italic;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">length</span><span style="color: #d6deeb;">();</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">divideScalar</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">length</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">||</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">1</span><span style="color: #d6deeb;">)</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">multiplyScalar</span><span style="color: #d6deeb;">(</span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">max</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">min</span><span style="color: #d6deeb;">, </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">min</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">max</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">length</span><span style="color: #d6deeb;">)));</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">floor</span><span style="color: #d9f5dd;">()</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">floor</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">floor</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">floor</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">ceil</span><span style="color: #d9f5dd;">()</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">ceil</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">ceil</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">ceil</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">round</span><span style="color: #d9f5dd;">()</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">round</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">round</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">round</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">roundToZero</span><span style="color: #d9f5dd;">()</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">&lt;</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">?</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">ceil</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;">) </span><span style="color: #c792ea;">:</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">floor</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">&lt;</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">?</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">ceil</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;">) </span><span style="color: #c792ea;">:</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">floor</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">&lt;</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">0</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">?</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">ceil</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">) </span><span style="color: #c792ea;">:</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">floor</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">negate</span><span style="color: #d9f5dd;">()</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">dot</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">v</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;} </span><span style="color: #637777;">//</span><span style="color: #637777;font-style: italic;"> TODO lengthSquared?</span></div><br><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">lengthSq</span><span style="color: #d9f5dd;">()</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">length</span><span style="color: #d9f5dd;">()</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">sqrt</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">manhattanLength</span><span style="color: #d9f5dd;">()</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">abs</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;">) </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">abs</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;">) </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> </span><span style="color: #c5e478;">Math</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #c5e478;">abs</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">normalize</span><span style="color: #d9f5dd;">()</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">divideScalar</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">length</span><span style="color: #d6deeb;">() </span><span style="color: #c792ea;">||</span><span style="color: #d6deeb;"> </span><span style="color: #f78c6c;">1</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">setLength</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">length</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">normalize</span><span style="color: #d6deeb;">()</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">multiplyScalar</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">length</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">lerp</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">v</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">alpha</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+=</span><span style="color: #d6deeb;"> (</span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;">) </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">alpha</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+=</span><span style="color: #d6deeb;"> (</span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;">) </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">alpha</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+=</span><span style="color: #d6deeb;"> (</span><span style="color: #7fdbca;font-style: italic;">v</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">) </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">alpha</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">lerpVectors</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">v1</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">v2</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">alpha</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">v1</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> (</span><span style="color: #7fdbca;font-style: italic;">v2</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">v1</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">x</span><span style="color: #d6deeb;">) </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">alpha</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">v1</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> (</span><span style="color: #7fdbca;font-style: italic;">v2</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">v1</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">y</span><span style="color: #d6deeb;">) </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">alpha</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">=</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">v1</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">+</span><span style="color: #d6deeb;"> (</span><span style="color: #7fdbca;font-style: italic;">v2</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">-</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;font-style: italic;">v1</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #baebe2;">z</span><span style="color: #d6deeb;">) </span><span style="color: #c792ea;">*</span><span style="color: #d6deeb;"> </span><span style="color: #d7dbe0;">alpha</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">;</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #82aaff;font-style: italic;">cross</span><span style="color: #d9f5dd;">(</span><span style="color: #d7dbe0;">v</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">w</span><span style="color: #d9f5dd;">)</span><span style="color: #d6deeb;"> {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;">if</span><span style="color: #d6deeb;"> (</span><span style="color: #d7dbe0;">w</span><span style="color: #d6deeb;"> </span><span style="color: #c792ea;">!==</span><span style="color: #d6deeb;"> </span><span style="color: #82aaff;">undefined</span><span style="color: #d6deeb;">) {</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #7fdbca;font-style: italic;">console</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">warn</span><span style="color: #d6deeb;">(</span><span style="color: #d9f5dd;">'</span><span style="color: #ecc48d;">THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.</span><span style="color: #d9f5dd;">'</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">crossVectors</span><span style="color: #d6deeb;">(</span><span style="color: #d7dbe0;">v</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">w</span><span style="color: #d6deeb;">);</span></div><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><br><div><span style="color: #d6deeb;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #c792ea;font-style: italic;">return</span><span style="color: #d6deeb;"> </span><span style="color: #7fdbca;">this</span><span style="color: #c792ea;font-style: italic;">.</span><span style="color: #82aaff;font-style: italic;">crossVectors</span><span style="color: #d6deeb;">(</span><span style="color: #7fdbca;">this</span><span style="color: #d6deeb;">, </span><span style="color: #d7dbe0;">v</span><span style="color: #d6deeb;">);</span></div></div>
        </div>
        <div class="facehead-gradient"></div>
        <picture class="facehead-image">
            <source srcset="/images/facehead-portrait.svg">
            <source srcset="/images/facehead-landscape.svg" media="(min-width: 640px)">
            <img src="/images/facehead-landscape.svg">
        </picture>
    </div>
          <nav class="header-nav">
        <ul class="header-nav-list">
          
            <li class="header-nav-item">
              <a href="/work/">
                <div class="header-nav-item-inner">
                  Work
                </div>
              </a>
            </li>
          
            <li class="header-nav-item">
              <a href="/projects/">
                <div class="header-nav-item-inner">
                  Projects
                </div>
              </a>
            </li>
          
            <li class="header-nav-item">
              <a href="/resume/">
                <div class="header-nav-item-inner">
                  Resume
                </div>
              </a>
            </li>
          
        </ul>
      </nav>
</header><main  class="page-home">
      <h1>Content not found.</h1>
<p>Go <a href="/">home</a>.</p>


    </main><div class="post-nav">
  
  

  

  <div class="post-nav-top"><a href="#page-top">Back to top</a> ↑</div>

  

</div><footer class="footer">
  <div class="footer-container">
    <nav class="footer-nav">
      <div class="footer-menu">
        <h3 class="footer-heading">Site</h3>
          <ul class="footer-nav-list">
          <li><a href='/'>Home</a></li>
          <li><a href="/work">Work</a></li>
          <li><a href="/projects">Projects</a></li>
          <li><a href="/resume">Resume</a></li>
        </ul>
      </div>
      <div class="footer-menu">
        <h3 class="footer-heading">Contact</h3>
        <ul class="footer-nav-list">
          <li><a href='&#109;ailt&#111;&#58;&#99;on&#116;&#97;c&#37;74&#64;%63&#37;68&#97;&#114;%6C%65&#37;&#55;3rob&#101;rt&#115;on%2Eio'><svg class="icon" role="presentation" focusable="false" width="16" height="16" fill="currentColor">
      <use xlink:href="#icon-email" />
    </svg>Email</a></li>
          <li><a href="https://twitter.com/tropical_nerd"><svg class="icon" role="presentation" focusable="false" width="16" height="16" fill="currentColor">
      <use xlink:href="#icon-twitter" />
    </svg>Twitter</a></li>
        </ul>
      </div>
      <div class="footer-menu">
        <h3 class="footer-heading">Elsewhere</h3>
          <ul class="footer-nav-list">
          <li><a href="https://github.com/tr0pical1nternet"><svg class="icon" role="presentation" focusable="false" width="16" height="16" fill="currentColor">
      <use xlink:href="#icon-github" />
    </svg>Github</a></li>
          <li><a href="https://codepen.io/tr0pical1nternet"><svg class="icon" role="presentation" focusable="false" width="16" height="16" fill="currentColor">
      <use xlink:href="#icon-codepen" />
    </svg>Codepen</a></li>
          <li><a href="https://cocohost.co"><svg class="icon" role="presentation" focusable="false" width="16" height="16" fill="currentColor">
      <use xlink:href="#icon-cocohost" />
    </svg>Cocohost</a></li>
        </ul>
      </div>
    </nav>
    <div class="footer-contentinfo">
      &copy;2019 Charles Robertson
    </div>
    <div class="footer-decoration" role="presentation"></div>
  </div>
</footer><script defer>
      document.querySelector('body').classList.remove('no-js');
    </script>
  </body>
</html>